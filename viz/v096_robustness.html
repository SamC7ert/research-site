<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>v0.96 Robustness — EFW, Mundlak, Host</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body, #root { width: 100%; height: 100%; background-color: white; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7/babel.min.js"></script>
    <script type="text/babel">
const { useState } = React;
const font = "'Libre Franklin','Helvetica Neue',Arial,sans-serif";

// ── Panel A: Cost gradient under each challenge ──
// Upper-half individual sports, Gini × ln(equipment cost)
const GRADIENT = [
  { label: "Baseline",       sub: "Our specification",          b: -2.537, se: 0.974, p: 0.013, color: "#1a1a2e" },
  { label: "+ EFW control",   sub: "Economic Freedom added",     b: -2.544, se: 0.970, p: 0.012, color: "#4a7ccc" },
  { label: "+ EFW × equip",   sub: "EFW as cost moderator",      b: -2.529, se: 1.020, p: 0.018, color: "#4a7ccc" },
  { label: "+ Host dummy",    sub: "Olympic host controlled",     b: -2.559, se: 0.975, p: 0.012, color: "#e67e22" },
  { label: "+ Mundlak means", sub: "Country time-averages",      b: -2.517, se: 0.970, p: 0.013, color: "#27ae60" },
];

// ── Panel B: The challengers themselves — all null ──
const CHALLENGERS = [
  { label: "EFW main effect",   sub: "After 10 region FE + ln(GDP)", b: 11.55,  se: 50.5, p: 0.819, color: "#4a7ccc" },
  { label: "EFW × equip cost",  sub: "As cost gradient moderator",   b: 2.91,   se: 3.50, p: 0.408, color: "#4a7ccc" },
  { label: "EFW threshold",     sub: "Gini × EFW > 7.1",            b: 12.89,  se: 8.70, p: 0.144, color: "#4a7ccc" },
  { label: "Host (gradient)",   sub: "In sport-level model",         b: 8.14,   se: 5.80, p: 0.169, color: "#e67e22" },
  { label: "Host (aggregate)",  sub: "+269 pts, ~4.5 golds",         b: 268.60, se: 148.0, p: 0.076, color: "#e67e22" },
  { label: "Mundlak mean Gini", sub: "Between-country Gini",         b: 0.94,   se: 0.99, p: 0.350, color: "#27ae60" },
];

function CoefRow({ d, sx, y, rowH, maxAbs, showVal }) {
  const lo = d.b - 1.96 * d.se;
  const hi = d.b + 1.96 * d.se;
  const sig = d.p < 0.05;
  const cy = y + rowH / 2;
  return (
    <g>
      <text x={sx(0) - maxAbs / (2 * maxAbs) * 10 - 145} y={cy - 2} textAnchor="start"
        style={{ fontSize: 10.5, fontWeight: 500, fill: "#333" }}>{d.label}</text>
      <text x={sx(0) - maxAbs / (2 * maxAbs) * 10 - 145} y={cy + 10} textAnchor="start"
        style={{ fontSize: 8, fill: "#999" }}>{d.sub}</text>
      {/* CI line */}
      <line x1={sx(lo)} y1={cy} x2={sx(hi)} y2={cy}
        stroke={sig ? d.color : "#ccc"} strokeWidth={1.8} />
      {/* Caps */}
      <line x1={sx(lo)} y1={cy - 4} x2={sx(lo)} y2={cy + 4}
        stroke={sig ? d.color : "#ccc"} strokeWidth={1} />
      <line x1={sx(hi)} y1={cy - 4} x2={sx(hi)} y2={cy + 4}
        stroke={sig ? d.color : "#ccc"} strokeWidth={1} />
      {/* Point */}
      <circle cx={sx(d.b)} cy={cy} r={4.5}
        fill={sig ? d.color : "white"} stroke={d.color} strokeWidth={1.8} />
      {/* Value label */}
      {showVal && (
        <text x={sx(hi) + 8} y={cy + 3.5}
          style={{ fontSize: 8.5, fill: "#888" }}>
          {d.b >= 0 ? "+" : ""}{Math.abs(d.b) > 100 ? Math.round(d.b) : d.b.toFixed(2)}
          {d.p < 0.01 ? "**" : d.p < 0.05 ? "*" : d.p < 0.1 ? "†" : ""}
        </text>
      )}
      {/* P-value */}
      <text x={sx(hi) + (showVal ? 52 : 8)} y={cy + 3.5}
        style={{ fontSize: 8, fill: sig ? "#333" : "#bbb", fontWeight: sig ? 600 : 400 }}>
        p={d.p < 0.001 ? "<.001" : d.p.toFixed(3)}
      </text>
    </g>
  );
}

function PanelA() {
  const W = 560, H = 220;
  const pad = { top: 36, right: 80, bottom: 24, left: 160 };
  const w = W - pad.left - pad.right;
  const h = H - pad.top - pad.bottom;
  const rowH = h / GRADIENT.length;
  const maxAbs = 5.5;
  const sx = (v) => pad.left + ((v + maxAbs) / (2 * maxAbs)) * w;

  const ticks = [-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5];

  return (
    <svg width={W} height={H} style={{ fontFamily: font }}>
      <text x={W / 2} y={14} textAnchor="middle"
        style={{ fontSize: 12, fontWeight: 600, fill: "#1a1a2e" }}>
        Cost Gradient Survives Every Challenge
      </text>
      <text x={W / 2} y={27} textAnchor="middle"
        style={{ fontSize: 9, fill: "#888" }}>
        Gini × ln(equipment cost), upper-half individual sports
      </text>
      {/* Zero line */}
      <line x1={sx(0)} y1={pad.top - 2} x2={sx(0)} y2={pad.top + h + 2}
        stroke="#ddd" strokeWidth={1} />
      {/* Baseline reference band */}
      <rect x={sx(-2.537 - 1.96 * 0.974)} y={pad.top}
        width={sx(-2.537 + 1.96 * 0.974) - sx(-2.537 - 1.96 * 0.974)} height={h}
        fill="#1a1a2e" opacity={0.04} />
      {/* Ticks */}
      {ticks.map(v => (
        <g key={v}>
          <line x1={sx(v)} y1={pad.top + h + 2} x2={sx(v)} y2={pad.top + h + 6}
            stroke="#999" strokeWidth={0.5} />
          <text x={sx(v)} y={pad.top + h + 16} textAnchor="middle"
            style={{ fontSize: 8, fill: "#888" }}>{v}</text>
        </g>
      ))}
      {/* Rows */}
      {GRADIENT.map((d, i) => (
        <CoefRow key={i} d={d} sx={sx} y={pad.top + i * rowH} rowH={rowH}
          maxAbs={maxAbs} showVal={true} />
      ))}
    </svg>
  );
}

function PanelB() {
  const W = 560, H = 260;
  const pad = { top: 36, right: 60, bottom: 24, left: 160 };
  const w = W - pad.left - pad.right;
  const h = H - pad.top - pad.bottom;
  const rowH = h / CHALLENGERS.length;

  // Different scale — normalize each row to fit
  // Use a "significance-centric" view: show each centered on 0
  // with its own scale
  return (
    <svg width={W} height={H} style={{ fontFamily: font }}>
      <text x={W / 2} y={14} textAnchor="middle"
        style={{ fontSize: 12, fontWeight: 600, fill: "#1a1a2e" }}>
        The Challengers Are All Null
      </text>
      <text x={W / 2} y={27} textAnchor="middle"
        style={{ fontSize: 9, fill: "#888" }}>
        Each variable tested as alternative explanation — none significant
      </text>
      {/* Zero line */}
      <line x1={pad.left} y1={pad.top - 2} x2={pad.left} y2={pad.top + h + 2}
        stroke="#999" strokeWidth={1} strokeDasharray="3,3" />
      <text x={pad.left} y={pad.top + h + 16} textAnchor="middle"
        style={{ fontSize: 8, fill: "#888" }}>0</text>

      {CHALLENGERS.map((d, i) => {
        const cy = pad.top + i * rowH + rowH / 2;
        const sig = d.p < 0.05;
        const lo = d.b - 1.96 * d.se;
        const hi = d.b + 1.96 * d.se;
        // Scale each row independently to fit
        const rowMax = Math.max(Math.abs(lo), Math.abs(hi)) * 1.2;
        const rsx = (v) => pad.left + (v / rowMax) * (w * 0.8);
        const crossesZero = lo <= 0 && hi >= 0;

        return (
          <g key={i}>
            <text x={pad.left - 8} y={cy - 2} textAnchor="end"
              style={{ fontSize: 10.5, fontWeight: 500, fill: "#333" }}>{d.label}</text>
            <text x={pad.left - 8} y={cy + 10} textAnchor="end"
              style={{ fontSize: 8, fill: "#999" }}>{d.sub}</text>
            {/* CI line */}
            <line x1={rsx(lo)} y1={cy} x2={rsx(hi)} y2={cy}
              stroke={sig ? d.color : "#ccc"} strokeWidth={1.8} />
            <line x1={rsx(lo)} y1={cy - 3} x2={rsx(lo)} y2={cy + 3}
              stroke={sig ? d.color : "#ccc"} strokeWidth={1} />
            <line x1={rsx(hi)} y1={cy - 3} x2={rsx(hi)} y2={cy + 3}
              stroke={sig ? d.color : "#ccc"} strokeWidth={1} />
            {/* Point */}
            <circle cx={rsx(d.b)} cy={cy} r={4}
              fill={crossesZero ? "white" : d.color}
              stroke={d.color} strokeWidth={1.5} />
            {/* Crosses-zero indicator */}
            {crossesZero && (
              <text x={rsx(hi) + 8} y={cy + 3.5}
                style={{ fontSize: 9, fill: "#c0392b", fontWeight: 600 }}>
                n.s.
              </text>
            )}
            {!crossesZero && d.label === "Host (aggregate)" && (
              <text x={rsx(hi) + 8} y={cy + 3.5}
                style={{ fontSize: 8, fill: "#e67e22" }}>
                p=0.076†
              </text>
            )}
            {/* p-value at right */}
            <text x={W - 10} y={cy + 3.5} textAnchor="end"
              style={{ fontSize: 8, fill: sig ? "#333" : "#bbb" }}>
              p={d.p < 0.001 ? "<.001" : d.p.toFixed(3)}
            </text>
          </g>
        );
      })}
      {/* Legend note */}
      <text x={pad.left} y={pad.top + h + 16}
        style={{ fontSize: 8, fill: "#999" }}>
        Each row scaled independently. Open circles = CI crosses zero (not significant).
      </text>
    </svg>
  );
}

function App() {
  const [panel, setPanel] = useState("gradient");
  const btnStyle = (active) => ({
    padding: "6px 14px", margin: "0 4px", border: "1px solid #ddd",
    borderRadius: 4, cursor: "pointer", fontFamily: font, fontSize: 11,
    background: active ? "#1a1a2e" : "white",
    color: active ? "white" : "#333", fontWeight: active ? 600 : 400,
  });
  return (
    <div style={{ display: "flex", flexDirection: "column", alignItems: "center",
      width: "100%", height: "100%", padding: "10px 5px" }}>
      <div style={{ marginBottom: 8 }}>
        <button style={btnStyle(panel === "gradient")}
          onClick={() => setPanel("gradient")}>Gradient Survives</button>
        <button style={btnStyle(panel === "challengers")}
          onClick={() => setPanel("challengers")}>Challengers Are Null</button>
      </div>
      {panel === "gradient" ? <PanelA /> : <PanelB />}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
</body>
</html>
